<html>
	<head>
		<title>Гайнетдинов А.Р. ЭАС-409 Лабораторная работа Вариант №75</title>
		<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>

		<script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

		<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/sunny/jquery-ui.css">

		<link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.css">

		<style>
			*{
				padding: 0;
				margin:0;
			}
			body{
				background: rgb(215, 255, 241);				
			}
			.telo
			{
				display:flex;
				justify-content: space-around;
				flex-wrap: wrap;
			}
			.tabs{
				width: 750px;
			}
			.logo
			{
				margin: auto;	
				display:flex;
				align-items: center;
				width: 600px;
				margin-bottom: 50px;
			}
			.plitka
			{
				width: 640px; 
				height: 540px;
				border: groove; 
				margin:20px;
				background: rgb(255, 255, 235);
			}
			#p
			{
				width: 498px;
				margin:0px;
				height: 403px;
			}
			.plitka1
			{
				width: 600px; 
				height: 500px;
				margin:20px;
			}
			button
			{
				margin-top: 20px;
				margin-left: 20px;
				margin-bottom: 20px;
			}
			label
			{
				margin-top: 20px;
				margin-left: 20px;
				margin-bottom: 20px;
			}
		</style>
		<script>
			var ovoch=100000
			var nom=0
			var t=0
			var timer1=[]
			var i=0
			var timer
			var date1
			var hh1
			var mm1
			var ss1
			var ovoch1=1000
			var x=0
			var b=80
			var vs1=0
			var ps1=0
			var vts1=0
			var brak1=0
			$(document).ready(function() {
				timer = setInterval(()=>{
					date1=new Date()
					hh1=date1.getHours()<10?"0"+date1.getHours():date1.getHours()
					mm1=date1.getMinutes()<10?"0"+date1.getMinutes():date1.getMinutes()
					ss1=date1.getSeconds()<10?"0"+date1.getSeconds():date1.getSeconds()
					$(".time").text(hh1+":"+mm1+":"+ss1)
				},50)
			}); 
			$(function(){
    			var tabl = $('#myTable').DataTable({
    				"language": {
                    	"zeroRecords": "Записей нет"
                 	},
                 	"scrollY": "400px",
	                "scrollX": true,
	                "scrollCollapse": true,
	                "paging": false,
	                "info": false,
	                "sDom": "lrtip",
	                "autoWidth": false
                })
                $('.tabs').tabs({})
                $("button").button()
                $("#UmenSkor").button({"disabled": true})
                $("#NormSkor").button({"disabled": true})
                $("#UvelSkor").button({"disabled": true})
                $("#Mehanic").button({"disabled": true})
                $("#Dezinsector").button({"disabled": true})
                $("#Pop").button({"disabled": true})
                $("#Vs").button({"disabled": true})
                $("#Ps").button({"disabled": true})
                $("#Vts").button({"disabled": true})
                $("#Br").button({"disabled": true})
                $("#Finished").button({"disabled": true})
                $( "input" ).checkboxradio()
                $("#UmenSkor").click(function(){
                	ovoch1=500
                	clearInterval(timer)
					for(i1=0;i1<=i;i1++){
						clearTimeout(timer1[i1])
					}
					t=0
					i=0
					b=40
					timer1=[]
					$("#UmenSkor").button({"disabled": true})
                	$("#NormSkor").button({"disabled": false})
                	$("#UvelSkor").button({"disabled": false})
                	$("#Start").click()
                })
                $("#NormSkor").click(function(){
                	ovoch1=1000
                	clearInterval(timer)
					for(i1=0;i1<=i;i1++){
						clearTimeout(timer1[i1])
					}
					t=0
					i=0
					b=80
					timer1=[]
					$("#UmenSkor").button({"disabled": false})
                	$("#NormSkor").button({"disabled": true})
                	$("#UvelSkor").button({"disabled": false})
                	$("#Start").click()
                })
                $("#UvelSkor").click(function(){
                	ovoch1=2000
                	clearInterval(timer)
					for(i1=0;i1<=i;i1++){
						clearTimeout(timer1[i1])
					}
					t=0
					i=0
					b=160
					timer1=[]
					$("#UmenSkor").button({"disabled": false})
                	$("#NormSkor").button({"disabled": false})
                	$("#UvelSkor").button({"disabled": true})
                	$("#Start").click()
                })
                $("#Start").click(function(){
                	if(x==0){
                		$("#UmenSkor").button({"disabled": false})
                		$("#UvelSkor").button({"disabled": false})
                		$("#Mehanic").button({"disabled": false})
                		$("#Dezinsector").button({"disabled": false})
                		$("#Pop").button({"disabled": false})
                		$("#Vs").button({"disabled": false})
                		$("#Ps").button({"disabled": false})
                		$("#Vts").button({"disabled": false})
                		$("#Br").button({"disabled": false})
                		$("#Finished").button({"disabled": false})
                		x=1
                		$("#zap").text(100)
                	}
					timer = setInterval(()=>{
						let min=5000
						let max=15000
						let t1=t
						t=Math.floor(Math.random() * (max - min)) + min
						t1=t+t1
						console.log(t1)
						timer1[i]=setTimeout(()=>{
							ovoch=ovoch-ovoch1
							let ov=(ovoch/100000)*100
							$("#zap").text(ov)
							let brak=Math.floor(Math.random() * b)
							let ovoch2=ovoch1-brak
							let vts=Math.floor(Math.random() * (ovoch2/2))
							ovoch2=ovoch2-vts
							let ps=Math.floor(Math.random() * ((ovoch2*2)/3))
							ovoch2=ovoch2-ps
							let vs=ovoch2
							let date=new Date()
							let hh=date.getHours()<10?"0"+date.getHours():date.getHours()
							let mm=date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes()
							let ss=date.getSeconds()<10?"0"+date.getSeconds():date.getSeconds()
							nom=nom+1
							vs1=vs1+vs
							let ov2=(vs1/5000)*100
							$("#vo").text(ov2.toFixed(1))
							ps1=ps1+ps
							let ov3=(ps1/5000)*100
							$("#oo").text(ov3.toFixed(1))
							vts1=vts1+vts
							let ov4=(vts1/5000)*100
							$("#vto").text(ov4.toFixed(1))
							brak1=brak1+brak
							let ov5=(brak1/5000)*100
							$("#bo").text(ov5.toFixed(1))
							tabl.row.add( [
                    			nom,
                    			vs,
                    			ps,
                    			vts,
                    			brak,
                    			date.getDate()+"."+(date.getMonth()+1)+"."+date.getFullYear()+" "+hh+":"+mm+":"+ss
                			] ).draw(true)
							VishiSort.data.push(vs)
							PerviSort.data.push(ps)
							VtoroiSort.data.push(vts)
							Brak.data.push(brak)
							speedData.labels.push(nom)
    						chart.data=speedData
    						chart.update();
						}, t1)
						i++
						t=t1
					},10)
				})
				$("#Finished").click(function(){
					clearInterval(timer)
					for(i1=0;i1<=i;i1++){
						clearTimeout(timer1[i1])
					}
					t=0
					i=0
					timer1=[]
					tabl.clear();
					tabl.draw();
					for(i2=0;i2<nom;i2++){
						chart.data.labels.pop();
    					chart.data.datasets.forEach((dataset) => {
        					dataset.data.pop();
    					});
    					chart.update();
    					vs1=0
						ps1=0
						vts1=0
						brak1=0
						$("#vo").text(0)
						$("#oo").text(0)
						$("#vto").text(0)
						$("#bo").text(0)
						ovoch=100000
						$("#zap").text(0)
    				}
    				$("#UmenSkor").button({"disabled": true})
                	$("#NormSkor").button({"disabled": true})
                	$("#UvelSkor").button({"disabled": true})
                	$("#Mehanic").button({"disabled": true})
                	$("#Dezinsector").button({"disabled": true})
                	$("#Pop").button({"disabled": true})
                	$("#Vs").button({"disabled": true})
                	$("#Ps").button({"disabled": true})
                	$("#Vts").button({"disabled": true})
                	$("#Br").button({"disabled": true})
                	$("#Finished").button({"disabled": true})
                	x=0
				})
    			var ctx = document.getElementById('myChart').getContext('2d');
    			var VishiSort = {
    				"label": "Высший сорт",
    				"data": 0,
    				"lineTension": 0,
    				"fill": false,
    				"backgroundColor": "rgba(255, 99, 132, 0.2)",
    				"borderColor": "rgba(255, 99, 132, 1)"
  				}
  				var PerviSort = {
    				"label": "Первый сорт",
    				"data": 0,
    				"lineTension": 0,
    				"fill": false,
  					"backgroundColor": "rgba(54, 162, 235, 0.2)",
    				"borderColor": "rgba(54, 162, 235, 1)"
  				}
  				var VtoroiSort = {
    				"label": "Второй сорт",
    				"data": 0,
    				"lineTension": 0,
    				"fill": false,
  					"backgroundColor": "rgba(255, 206, 86, 0.2)",
    				"borderColor": "rgba(255, 206, 86, 1)"
  				}
  				var Brak = {
    				"label": "Брак",
    				"data": 0,
    				"lineTension": 0,
    				"fill": false,
  					"backgroundColor": "rgba(75, 192, 192, 0.2)",
    				"borderColor": "rgba(75, 192, 192, 1)"
  				}
  				var speedData = {
  					"labels": 0,
  					"datasets": [VishiSort, PerviSort, VtoroiSort, Brak]
				}
				var chart = new Chart(ctx, {
    				"type": 'line',
    				"data":speedData, 
				    "options": {
				        "scales": {
				            "yAxes": [{
				                "ticks": {
				                    "beginAtZero": true
				                }
				            }]
				        }
				    }
    			})
			})
		</script>
	</head>
	<body>
		<div class = "head" style="background: rgb(70,166,132);">
			<div class="logo">
				<div class="time" style="font-family: 'Times New Roman';font-size: 24px;font-weight:bold; color: white;"></div>
				<h1 style="color: white; margin-left: 20px;">Сортировка овощей</h1>
			</div>
		</div>
		<div class="telo">
			<div class="tabs">
				<ul>
					<li><a href="#tabs-1">Управление</a></li>
					<li><a href="#tabs-2">Таблица</a></li>
				</ul>
				<div id="tabs-1">
					<div class="plitka6">
						<label for="checkbox-1">Система автоматического принятия решения</label>
		    			<input type="checkbox" name="checkbox-1" id="checkbox-1">
					</div>
					<div class="plitka2">	
						<button id="Start">Начало работы</button>
						<button id="Finished">Завершение работы</button>
					</div>
					<div class="plitka3">
						<h2>Настройка скорости</h2>
						<button id="UmenSkor">0.5x</button>
						<button id="NormSkor">1X</button>
						<button id="UvelSkor">2x</button>
					</div>
					<div class="plitka4">
						<h2>Вызов работника</h2>
						<button id="Mehanic">Механик</button>
						<button id="Dezinsector">Дезинсектор</button>
					</div>
					<div class="plitka5">
						<h2>Слад</h2>
						<div><b>Объем запаса равен </b><b id="zap" style="color: blue;">0</b><b> %</b></div>
						<button id="Pop">Пополнить запас</button>
						<h2>Контейнер</h2>
						<div><b>Запоненность контейнера:</b></div>
						<div><b>Высший сорт </b><b id="vo" style="color: blue;">0</b><b> %</b><button id="Vs">Замена</button><b> Первый сорт </b><b id="oo" style="color: blue;">0</b><b> %</b><button id="Ps">Замена</button><br/><b>Второй сорт </b><b id="vto" style="color: blue;">0</b><b> %</b><button id="Vts">Замена</button><b> Брак </b><b id="bo" style="color: blue;">0</b><b> %</b><button id="Br">Замена</button></div>
					</div>
				</div>
				<div id="tabs-2">
					<div class="plitka1">
						<table id="myTable" class="display" cellspacing="0">
							<thead>
								<tr>
									<th>Номер партии</th>
									<th>Высший сорт, кг</th>
									<th>Первый сорт, кг</th>
									<th>Второй сорт, кг</th>
									<th>Брак, кг</th>
									<th>Дата и время</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
			<div class="plitka">
				<canvas id="myChart" width="600" height="500"></canvas>
			</div>
			
		</div>
	</body>
</html>
